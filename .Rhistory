zeroline = FALSE))
p
p <- plot_ly(early_years, x = ~year, y = ~high, type = 'scatter', mode = 'lineandmarkers',
line = list(color = 'rgb(150, 150, 250)'),
showlegend = FALSE, name = 'High 2014') %>%
add_trace(y = ~low, type = 'scatter', mode = 'lines',
fill = 'tonexty', fillcolor='rgb(150, 150, 250)', line = list(color = 'transparent'),
showlegend = FALSE, name = 'Low 2014') %>%
add_trace(x = ~year, y = ~average, type = 'scatter', mode = 'lines',marker=list( size=5 , opacity=0.5),
line = list(color='rgb(100,0,80)'),marker=list( size=5 , opacity=0.5, color="black"),
name = 'Average') %>%
layout(title = "Average, High and Low Temperatures in New York",
paper_bgcolor='rgb(255,255,255)',
xaxis = list(title = "Months",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE),
yaxis = list(title = "Temperature (degrees F)",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE))
p
p <- plot_ly(early_years, x = ~year, y = ~high, type = 'scatter', mode = 'lineandmarkers',
line = list(color = 'rgb(150, 150, 250)', opacity=0.5),
showlegend = FALSE, name = 'High 2014') %>%
add_trace(y = ~low, type = 'scatter', mode = 'lines',
fill = 'tonexty', fillcolor='rgb(150, 150, 250)', line = list(color = 'transparent'),
showlegend = FALSE, name = 'Low 2014') %>%
add_trace(x = ~year, y = ~average, type = 'scatter', mode = 'lines',marker=list( size=5 , opacity=0.5),
line = list(color='rgb(100,0,80)'),marker=list( size=5 , opacity=0.5, color="black"),
name = 'Average') %>%
layout(title = "Average, High and Low Temperatures in New York",
paper_bgcolor='rgb(255,255,255)',
xaxis = list(title = "Months",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE),
yaxis = list(title = "Temperature (degrees F)",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE))
p
p <- plot_ly(early_years, x = ~year, y = ~high, type = 'scatter', mode = 'lineandmarkers',
line = list(color = 'rgb(150, 150, 250)'),
showlegend = FALSE, name = 'High 2014') %>%
add_trace(y = ~low, type = 'scatter', mode = 'lines',
fill = 'tonexty', fillcolor='rgb(150, 150, 250)', line = list(color = 'transparent'),
showlegend = FALSE, name = 'Low 2014') %>%
add_trace(x = ~year, y = ~average, type = 'scatter', mode = 'lines',marker=list( size=5 , opacity=0.5),
line = list(color='rgb(100,0,80)'),marker=list( size=5 , opacity=0.5, color="black"),
name = 'Average') %>%
layout(title = "Average, High and Low Temperatures in New York",
paper_bgcolor='rgb(255,255,255)',
xaxis = list(title = "Months",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE),
yaxis = list(title = "Temperature (degrees F)",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE))
p
p <- plot_ly(early_years, x = ~year, y = ~high, type = 'scatter', mode = 'lineandmarkers',
line = list(color = 'rgb(127,127,127)'),
showlegend = FALSE, name = 'High 2014') %>%
add_trace(y = ~low, type = 'scatter', mode = 'lines',
fill = 'tonexty', fillcolor='rgb(127,127,127)', line = list(color = 'transparent'),
showlegend = FALSE, name = 'Low 2014') %>%
add_trace(x = ~year, y = ~average, type = 'scatter', mode = 'lines',marker=list( size=5 , opacity=0.5),
line = list(color='rgb(100,0,80)'),marker=list( size=5 , opacity=0.5, color="black"),
name = 'Average') %>%
layout(title = "Average, High and Low Temperatures in New York",
paper_bgcolor='rgb(255,255,255)',
xaxis = list(title = "Months",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE),
yaxis = list(title = "Temperature (degrees F)",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE))
p
p <- plot_ly(early_years, x = ~year, y = ~high, type = 'scatter', mode = 'lineandmarkers',
line = list(color = 'rgb(150, 150, 250)'),
showlegend = FALSE, name = 'High 2014') %>%
add_trace(y = ~low, type = 'scatter', mode = 'lines',
fill = 'tonexty', fillcolor='rgb(150, 150, 250)', line = list(color = 'transparent'),
showlegend = FALSE, name = 'Low 2014') %>%
add_trace(x = ~year, y = ~average, type = 'scatter', mode = 'lines',marker=list( size=5 , opacity=0.5),
line = list(color='rgb(100,0,80)'),marker=list( size=5 , opacity=0.5, color="black"),
name = 'Average') %>%
layout(title = "Average, High and Low Temperatures in New York",
paper_bgcolor='rgb(255,255,255)',
xaxis = list(title = "Months",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE),
yaxis = list(title = "Temperature (degrees F)",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE))
p
p <- plot_ly(early_years, x = ~year, y = ~high, type = 'scatter', mode = 'lines',
line = list(color = 'rgb(150, 150, 250)'),
showlegend = FALSE, name = 'High 2014') %>%
add_trace(y = ~low, type = 'scatter', mode = 'lines',
fill = 'tonexty', fillcolor='rgb(150, 150, 250)', line = list(color = 'transparent'),
showlegend = FALSE, name = 'Low 2014') %>%
add_trace(x = ~year, y = ~average, type = 'scatter', mode = 'lines',marker=list( size=5 , opacity=0.5),
line = list(color='rgb(100,0,80)'),marker=list( size=5 , opacity=0.5, color="black"),
name = 'Average') %>%
layout(title = "Average, High and Low Temperatures in New York",
paper_bgcolor='rgb(255,255,255)',
xaxis = list(title = "Months",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE),
yaxis = list(title = "Temperature (degrees F)",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE))
p
p <- plot_ly(early_years, x = ~year, y = ~high, type = 'scatter', mode = 'lines',
line = list(color = 'rgb(150, 150, 250)'),
showlegend = FALSE, name = 'High 2014') %>%
add_trace(y = ~low, type = 'scatter', mode = 'lines',
fill = 'tonexty', fillcolor='rgb(150, 150, 250)', line = list(color = 'transparent'),
showlegend = FALSE, name = 'Low 2014') %>%
add_trace(x = ~year, y = ~average, type = 'scatter', mode = 'linesandmarkers', marker=list( size=5 , opacity=0.5),
line = list(color='rgb(100,0,80)'),marker=list( size=5 , opacity=0.5, color="black"),
name = 'Average') %>%
layout(title = "Average, High and Low Temperatures in New York",
paper_bgcolor='rgb(255,255,255)',
xaxis = list(title = "Months",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE),
yaxis = list(title = "Temperature (degrees F)",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE))
p
p <- plot_ly(early_years, x = ~year, y = ~high, type = 'scatter', mode = 'lines',
line = list(color = 'rgb(127,127,127)'),
showlegend = FALSE, name = 'High 2014') %>%
add_trace(y = ~low, type = 'scatter', mode = 'lines',
fill = 'tonexty', fillcolor='rgb(127,127,127)', line = list(color = 'transparent'),
showlegend = FALSE, name = 'Low 2014') %>%
add_trace(x = ~year, y = ~average, type = 'scatter', mode = 'linesandmarkers', marker=list( size=5 , opacity=0.5),
line = list(color='rgb(100,0,80)'),marker=list( size=5 , opacity=0.5, color="black"),
name = 'Average') %>%
layout(title = "Average, High and Low Temperatures in New York",
paper_bgcolor='rgb(255,255,255)',
xaxis = list(title = "Months",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE),
yaxis = list(title = "Temperature (degrees F)",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE))
p
p <- plot_ly(early_years, x = ~year, y = ~high, type = 'scatter', mode = 'lines',
line = list(color = 'rgb(100, 0, 80)'),
showlegend = FALSE, name = 'High 2014') %>%
add_trace(y = ~low, type = 'scatter', mode = 'lines',
fill = 'tonexty', fillcolor='rgb(100, 0, 80)', line = list(color = 'transparent'),
showlegend = FALSE, name = 'Low 2014') %>%
add_trace(x = ~year, y = ~average, type = 'scatter', mode = 'linesandmarkers', marker=list( size=5 , opacity=0.5),
line = list(color='rgb(100,0,80)'),marker=list( size=5 , opacity=0.5, color="black"),
name = 'Average') %>%
layout(title = "Average, High and Low Temperatures in New York",
paper_bgcolor='rgb(255,255,255)',
xaxis = list(title = "Months",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE),
yaxis = list(title = "Temperature (degrees F)",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE))
p
p <- plot_ly(early_years, x = ~year, y = ~high, type = 'scatter', mode = 'lines',
line = list(color = 'rgb(150, 200, 250)'),
showlegend = FALSE, name = 'High 2014') %>%
add_trace(y = ~low, type = 'scatter', mode = 'lines',
fill = 'tonexty', fillcolor='rgb(150, 200, 250)', line = list(color = 'transparent'),
showlegend = FALSE, name = 'Low 2014') %>%
add_trace(x = ~year, y = ~average, type = 'scatter', mode = 'linesandmarkers', marker=list( size=5 , opacity=0.5),
line = list(color='rgb(100,0,80)'),marker=list( size=5 , opacity=0.5, color="black"),
name = 'Average') %>%
layout(title = "Average, High and Low Temperatures in New York",
paper_bgcolor='rgb(255,255,255)',
xaxis = list(title = "Months",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE),
yaxis = list(title = "Temperature (degrees F)",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE))
p
p <- plot_ly(early_years, x = ~year, y = ~high, type = 'scatter', mode = 'lines',
line = list(color = 'rgb(150, 200, 250)'),
showlegend = FALSE, name = 'High 2014') %>%
add_trace(y = ~low, type = 'scatter', mode = 'lines',
fill = 'tonexty', fillcolor='rgb(150, 200, 250)', line = list(color = 'transparent'),
showlegend = FALSE, name = 'Low 2014') %>%
add_trace(x = ~year, y = ~average, type = 'scatter', mode = 'linesandmarkers', marker=list( size=5 , opacity=0.5),
line = list(color='rgb(100,0,80)'),marker=list( size=5 , opacity=0.5, color="black"),
name = 'Average') %>%
layout(title = "Average, High and Low Temperatures in New York",
paper_bgcolor='rgb(127,127,127)',
xaxis = list(title = "Months",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE),
yaxis = list(title = "Temperature (degrees F)",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE))
p
p <- plot_ly(early_years, x = ~year, y = ~high, type = 'scatter', mode = 'lines',
line = list(color = 'rgb(150, 200, 250)'),
showlegend = FALSE, name = 'High 2014') %>%
add_trace(y = ~low, type = 'scatter', mode = 'lines',
fill = 'tonexty', fillcolor='rgb(150, 200, 250)', line = list(color = 'transparent'),
showlegend = FALSE, name = 'Low 2014') %>%
add_trace(x = ~year, y = ~average, type = 'scatter', mode = 'linesandmarkers', marker=list( size=5 , opacity=0.5),
line = list(color='rgb(100,0,80)'),marker=list( size=5 , opacity=0.5, color="black"),
name = 'Average') %>%
layout(title = "Average, High and Low Temperatures in New York",
paper_bgcolor='rgb(255,255,255)',
xaxis = list(title = "Months",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE),
yaxis = list(title = "Temperature (degrees F)",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE))
p
p <- plot_ly(early_years, x = ~year, y = ~high, type = 'scatter', mode = 'lines',
line = list(color = 'rgb(150, 200, 250)'),
showlegend = FALSE, name = 'High 2014') %>%
add_trace(y = ~low, type = 'scatter', mode = 'lines',
fill = 'tonexty', fillcolor='rgb(150, 200, 250)', line = list(color = 'transparent'),
showlegend = FALSE, name = 'Low 2014') %>%
add_trace(x = ~year, y = ~average, type = 'scatter', mode = 'linesandmarkers', marker=list( size=5 , opacity=0.5),
line = list(color='rgb(70,150,80)'),marker=list( size=5 , opacity=0.5, color="black"),
name = 'Average') %>%
layout(title = "Average, High and Low Temperatures in New York",
paper_bgcolor='rgb(255,255,255)',
xaxis = list(title = "Months",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE),
yaxis = list(title = "Temperature (degrees F)",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE))
p
p <- plot_ly(early_years, x = ~year, y = ~high, type = 'scatter', mode = 'lines',
line = list(color = 'rgb(150, 200, 250)'),
showlegend = FALSE, name = 'High 2014') %>%
add_trace(y = ~low, type = 'scatter', mode = 'lines',
fill = 'tonexty', fillcolor='rgb(150, 200, 250)', line = list(color = 'transparent'),
showlegend = FALSE, name = 'Low 2014') %>%
add_trace(x = ~year, y = ~average, type = 'scatter', mode = 'linesandmarkers', marker=list( size=5 , opacity=0.5),
line = list(color='rgb(70,150,80)'),marker=list( size=5 , opacity=0.5, color="black"),
name = 'Average') %>%
layout(title = "World Population Estimation of Early Ages\n (1 A.D - 1800 A.D)",
paper_bgcolor='rgb(255,255,255)',
xaxis = list(title = "Years",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE),
yaxis = list(title = "World Population (in millions)",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE))
p
knitr::opts_chunk$set(echo = TRUE)
early_years <- early_years %>%
mutate(average = (low+high)/2)
p <- plot_ly(early_years, x = ~year, y = ~high, type = 'scatter', mode = 'lines',
line = list(color = 'rgb(150, 200, 250)'),
showlegend = FALSE, name = "Higher Estimate") %>%
add_trace(y = ~low, type = 'scatter', mode = 'lines',
fill = 'tonexty', fillcolor='rgb(150, 200, 250)', line = list(color = 'transparent'),
showlegend = FALSE, name = "Lower Estimate") %>%
add_trace(x = ~year, y = ~average, type = 'scatter', mode = 'linesandmarkers', marker=list( size=5 , opacity=0.5),
line = list(color='rgb(70,150,80)'),marker=list( size=5 , opacity=0.5, color="black"),
name = '(Year, Average Value)') %>%
layout(title = "World Population Estimation of Early Ages\n (1 A.D - 1800 A.D)",
paper_bgcolor='rgb(255,255,255)',
xaxis = list(title = "Years",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE),
yaxis = list(title = "World Population (in millions)",
#gridcolor = 'rgb(255,255,255)',
showgrid = TRUE,
showline = FALSE,
showticklabels = TRUE,
tickcolor = 'rgb(127,127,127)',
ticks = 'outside',
zeroline = FALSE))
View(early_years)
{
library(dplyr)
library(ggplot2)
library(tidyr)
library(dplyr)
library(plotly)
}
setwd('/home/nicole/Data Science/exam_big_data')
pop <- read.csv("Datasets/total_population.csv", skip=4)
{
w <- pop %>%
filter(Country.Name=="World")%>%
select(-Country.Name, -Country.Code, -Indicator.Name, -Indicator.Code, -X)
colnames(w) <- c(substring(colnames(w[,1:length(w)]), 2))
colnames(w)
w[2,]<- colnames(w)
w <- data.frame(t(w))
colnames(w) <- c("world_pop", "year")
w$world_pop <- as.numeric(as.character(w$world_pop))
w$year <- as.numeric(as.character(w$year))
}
newdata <- seq(2018,2100)
newdata <- data.frame(newdata)
colnames(newdata)[1] <- "year"
mod <- lm(world_pop ~ year, w)
lmod <- predict(mod, newdata)
newdata$lm <- data.frame(lmod)
mod <- nls(world_pop ~ SSlogis(year, phi1, phi2, phi3), data = w)
pred <- predict(mod, newdata)
vv <- data.frame(pred)
newdata$world_pop <- data.frame(pred[1:83])
newdata <- newdata %>%
select(world_pop, year, -lm)
newdata$world_pop <- as.numeric(unlist(newdata$world_pop))
tot <- rbind(w, newdata)
p1 <- plot_ly(tot, x = ~year, y = ~world_pop, name = 'popolation', type = 'scatter', mode = 'lines+markers') %>%
layout(title = "Predicted trend of world population growth until 2100",
xaxis = list(title = "Year"),
yaxis = list (title = paste("Pop qunatity ")))
p1
View(newdata)
newdata <- seq(2018,2100)
newdata <- data.frame(newdata)
colnames(newdata)[1] <- "year"
mod <- lm(world_pop ~ year, w)
lmod <- predict(mod, newdata)
newdata$lm <- data.frame(lmod)
mod <- nls(world_pop ~ SSlogis(year, phi1, phi2, phi3), data = w)
pred <- predict(mod, newdata)
vv <- data.frame(pred)
newdata$world_pop <- data.frame(pred[1:83])
newdata <- newdata %>%
select(world_pop, year, lm)
newdata$world_pop <- as.numeric(unlist(newdata$world_pop))
View(w)
w$lm <- w$world_pop
tot <- rbind(w, newdata)
View(tot)
w$lm <- as.numeric(unlist(w$world_pop))
tot <- rbind(w, newdata)
newdata$lm <- as.numeric(unlist(newdata$lm))
w$lm <- w$world_pop
tot <- rbind(w, newdata)
p1 <- plot_ly(tot, x = ~year, y = ~world_pop, name = 'popolation', type = 'scatter', mode = 'lines+markers') %>%
add_trace(y = ~lm, name = 'lm', mode = 'lines+markers') %>%
layout(title = "Predicted trend of world population growth until 2100",
xaxis = list(title = "Year"),
yaxis = list (title = paste("Pop qunatity ")))
p1
p1 <- plot_ly(tot, x = ~year, y = ~world_pop, name = 'Logistic model', type = 'scatter', mode = 'lines+markers') %>%
add_trace(y = ~lm, name = 'Lineaar model', mode = 'lines+markers') %>%
layout(title = "Predicted trend of world population growth until 2100",
xaxis = list(title = "Year"),
yaxis = list (title = paste("Pop qunatity ")))
p1
?? nlm
??nlm
f <- function(t, N0, rate) {
val <- N0*rate^(t)
return(val)
}
?nlm
?nls
??SSlogis
expmod <- nls(world_pop ~ SSbiexp(year, A1, lrc1, A2, lrc2), data = w)
expmod <- nls(world_pop ~ SSbiexp(year, A1, lrc1, 0, lrc2), data = w)
expmod <- nls(world_pop ~ SSbiexp(year, A1, lrc1, 0, 1), data = w)
